## 5.4 봉화희제후와 메모리 장벽

봉화희제후란 중국의 양치기 소년 이야기이다.

어떻게 캐시를 갱신하고 일관성을 유지시킬까?

이 과정은 비교적 시간을 많이 소모하고, 이 작업 전에는 반드시 CPU가 대기 상태를 중지해야 한다.

일반적으로 다중 스레드에서 공유 리소스를 사용하는 작업은 잠금을 통한 보호가 필요하다고 이야기 한다. 하지만 실제로는 잠금이 반드시 필요한 것은 아니며, 잠금이 없어도 리소스에 접근할 수 있다.

그 원리는 compare-and-swap(CAS) 알고리즘과 같은 원자성 작업을 사용하면 된다.

그렇다면 비순차적 실행 문제는 어떻게 해야 할까?

메모리 장벽을 사용해서 해결할 수 있으며, 그 유형에는 LoadLoad, StoreStore, LoadStore, StoreLoad 네 가지 유형이 존재한다. 모든 이름은 이런 비순차적 실행을 금지한다는 의미를 가진다.


---

# 6. 입출력이 없는 컴퓨터가 있을까?

## 6.1 CPU는 어떻게 입출력 작업을 처리할까?

장치 레지스터는 두 가지 레지스터가 존재한다.

1. 데이터를 저장하는 레지스터
2. 제어 정보와 상태 정보를 저장하는 레지스터

CPU가 키보드를 사용자가 입력한다는 것을 인식하는 방법

1. 폴링: 동기식 설계 방법
2. 인터럽트: 비동기식 설계 방법


## 6.2 디스크가 입출력을 처리할 때 CPU가 하는 일은 무엇일까?

최신 컴퓨터의 경우 디스크가 입출력을 처리할 때 CPU 개입이 필요하지 않다. 디스크가 입출력 요청을 처리하는 동안 운영 체제는 CPU가 다른 작업을 수행하도록 스케줄링한다.

DMA(Direct Memory Access)를 사용하면 CPU의 개입 없이 메모리와 외부 장치 사이에서 직접 데이터를 이동할 수 있다.

